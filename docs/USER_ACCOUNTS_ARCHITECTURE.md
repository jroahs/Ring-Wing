# User Accounts System - Architecture Diagrams

## ğŸ—ºï¸ System Architecture Overview

This document provides visual representations of the customer account system architecture, data flows, and relationships.

---

## ğŸ“Š Data Model Relationships

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     DATABASE SCHEMA                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Customer      â”‚         â”‚  CustomerAddress â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ _id (PK)         â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ _id (PK)         â”‚
â”‚ phone (unique)   â”‚         â”‚ customerId (FK)  â”‚
â”‚ email            â”‚         â”‚ recipientName    â”‚
â”‚ password (hash)  â”‚         â”‚ recipientPhone   â”‚
â”‚ firstName        â”‚         â”‚ street           â”‚
â”‚ lastName         â”‚         â”‚ barangay         â”‚
â”‚ defaultAddressIdâ”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ city             â”‚
â”‚ totalOrders      â”‚         â”‚ province         â”‚
â”‚ totalSpent       â”‚         â”‚ postalCode       â”‚
â”‚ createdAt        â”‚         â”‚ landmark         â”‚
â”‚ lastLogin        â”‚         â”‚ deliveryNotes    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ isDefault        â”‚
         â”‚                   â”‚ isActive         â”‚
         â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 1:N
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Order       â”‚         â”‚ OrderStatusHist  â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ _id (PK)         â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ _id (PK)         â”‚
â”‚ receiptNumber    â”‚         â”‚ orderId (FK)     â”‚
â”‚ customerId (FK)  â”‚â”€ â”€ â”€ â”€ â–¶â”‚ status           â”‚
â”‚ items []         â”‚         â”‚ changedBy        â”‚
â”‚ totals {}        â”‚         â”‚ timestamp        â”‚
â”‚ customerDetails{}â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ orderType        â”‚
â”‚ fulfillmentType  â”‚
â”‚ deliveryAddressIdâ”‚â”€â”
â”‚ deliveryAddress{}â”‚ â”‚
â”‚ paymentMethod    â”‚ â”‚
â”‚ status           â”‚ â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ createdAt        â”‚ â”‚       â”‚      User        â”‚
â”‚ completedAt      â”‚ â”‚       â”‚   (Staff/Admin)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
                     â””â”€â”€â”€â”€â”€â”€â–ºâ”‚ _id (PK)         â”‚
                             â”‚ username         â”‚
                             â”‚ email            â”‚
                             â”‚ role             â”‚
                             â”‚ position         â”‚
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Legend:
â”€â”€â”€â”€â”€â–º Reference/Foreign Key
â—„â”€â”€â”€â”€â”¤ One-to-Many Relationship
â”€ â”€ â–¶ Optional Relationship
```

---

## ğŸ”„ User Authentication Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Browser   â”‚
â”‚ (Customer)  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 1. Open Self-Checkout
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      SelfCheckout.jsx                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  CustomerAuthContext              â”‚  â”‚
â”‚  â”‚  â”œâ”€ customer: null                â”‚  â”‚
â”‚  â”‚  â”œâ”€ isAuthenticated: false        â”‚  â”‚
â”‚  â”‚  â””â”€ token: null                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                         â”‚
â”‚  [Login Button] [Sign Up Button]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”‚ 2. Click "Sign Up" or "Login"
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    CustomerAuthModal.jsx                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  Sign Up    â”‚   Login     â”‚          â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚
â”‚  â”‚ Phone: [___________]      â”‚          â”‚
â”‚  â”‚ Password: [___________]   â”‚          â”‚
â”‚  â”‚ [Submit Button]           â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”‚ 3. POST /api/customer/auth/signup
              â”‚    POST /api/customer/auth/login
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Backend API                           â”‚
â”‚   (customerAuthController.js)           â”‚
â”‚                                         â”‚
â”‚   1. Validate input                     â”‚
â”‚   2. Check if customer exists           â”‚
â”‚   3. Hash password (bcrypt)             â”‚
â”‚   4. Save to MongoDB                    â”‚
â”‚   5. Generate JWT token                 â”‚
â”‚   6. Return { customer, token }         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”‚ 4. Response with JWT
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   useCustomerAuth Hook                  â”‚
â”‚                                         â”‚
â”‚   1. Store token in localStorage        â”‚
â”‚   2. Update CustomerAuthContext         â”‚
â”‚   3. Close modal                        â”‚
â”‚   4. Trigger cart sync                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”‚ 5. Context Updated
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      SelfCheckout.jsx                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  CustomerAuthContext              â”‚  â”‚
â”‚  â”‚  â”œâ”€ customer: { id, name, ... }   â”‚  â”‚
â”‚  â”‚  â”œâ”€ isAuthenticated: true         â”‚  â”‚
â”‚  â”‚  â””â”€ token: "eyJhbGc..."           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                         â”‚
â”‚  Welcome, Juan! â–¼                       â”‚
â”‚  â”œâ”€ My Orders                           â”‚
â”‚  â”œâ”€ Addresses                           â”‚
â”‚  â””â”€ Logout                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ›’ Cart Management Flow

```
SCENARIO 1: Guest User Adds Items
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Customer  â”‚
â”‚ (Not loggedâ”‚
â”‚    in)     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 1. Browse menu, add items
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   useCart Hook               â”‚
â”‚   (localStorage only)        â”‚
â”‚                              â”‚
â”‚   cartItems = [              â”‚
â”‚     { id: 1, name: ..., }    â”‚
â”‚     { id: 2, name: ..., }    â”‚
â”‚   ]                          â”‚
â”‚                              â”‚
â”‚   localStorage.setItem(      â”‚
â”‚     'ringwing_cart_v1',      â”‚
â”‚     JSON.stringify(items)    â”‚
â”‚   )                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


SCENARIO 2: User Logs In with Items in Cart
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Customer  â”‚
â”‚ (Logging   â”‚
â”‚    in)     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 1. Login successful
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   useCustomerAuth Hook       â”‚
â”‚                              â”‚
â”‚   1. Get localStorage cart   â”‚
â”‚   2. Check server cart       â”‚
â”‚   3. Merge carts             â”‚
â”‚   4. Save to server          â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 2. POST /api/customer/cart/sync
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Backend API                â”‚
â”‚                              â”‚
â”‚   LocalStorage Cart:         â”‚
â”‚   [Item A, Item B]           â”‚
â”‚   +                          â”‚
â”‚   Server Cart:               â”‚
â”‚   [Item C]                   â”‚
â”‚   =                          â”‚
â”‚   Merged Cart:               â”‚
â”‚   [Item A, Item B, Item C]   â”‚
â”‚                              â”‚
â”‚   Save to CustomerCart DB    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 3. Return merged cart
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CartContext Updated        â”‚
â”‚                              â”‚
â”‚   cartItems = [              â”‚
â”‚     Item A, Item B, Item C   â”‚
â”‚   ]                          â”‚
â”‚                              â”‚
â”‚   Customer sees all items    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


SCENARIO 3: Logged-in User Across Devices
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Device 1                    Device 2
â”€â”€â”€â”€â”€â”€â”€â”€                    â”€â”€â”€â”€â”€â”€â”€â”€
Add Item A  â”€â”€â”€â”€â”€â”€â”€â”        
Add Item B         â”‚        
                   â–¼        
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Server Cart  â”‚
            â”‚ [A, B]       â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚        
                   â”‚        
                   â–¼        
            Login on Device 2
                   â”‚        
                   â–¼        
            Load cart from server
                   â”‚        
                   â–¼        
            Device 2 shows [A, B]
```

---

## ğŸ“¦ Order Creation Flow with Customer Account

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Customer   â”‚
â”‚ (Logged in) â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 1. Add items to cart
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CartContext                           â”‚
â”‚   cartItems = [Item A, Item B, ...]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”‚ 2. Click "Checkout"
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Checkout Flow                         â”‚
â”‚                                         â”‚
â”‚   Step 1: Select Order Type             â”‚
â”‚   âšª Dine-In                            â”‚
â”‚   âšª Take-Out                           â”‚
â”‚   âšª Delivery âœ“                         â”‚
â”‚                                         â”‚
â”‚   Step 2: Select Delivery Address       â”‚
â”‚   âšª Home - 123 Street, Manila âœ“        â”‚
â”‚   âšª Work - 456 Ave, Makati             â”‚
â”‚   [+ Add New Address]                   â”‚
â”‚                                         â”‚
â”‚   Step 3: Select Payment                â”‚
â”‚   âšª GCash âœ“                            â”‚
â”‚   âšª PayMaya                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”‚ 3. Click "Place Order"
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Build Order Payload                   â”‚
â”‚                                         â”‚
â”‚   {                                     â”‚
â”‚     customerId: "507f1f...",            â”‚
â”‚     customerDetails: {                  â”‚
â”‚       name: "Juan Dela Cruz",           â”‚
â”‚       phone: "09171234567",             â”‚
â”‚       email: "juan@example.com"         â”‚
â”‚     },                                  â”‚
â”‚     items: [...],                       â”‚
â”‚     totals: { ... },                    â”‚
â”‚     fulfillmentType: "delivery",        â”‚
â”‚     deliveryAddressId: "507f2a...",     â”‚
â”‚     deliveryAddress: {                  â”‚
â”‚       recipientName: "Juan Dela Cruz",  â”‚
â”‚       street: "123 Street",             â”‚
â”‚       city: "Manila",                   â”‚
â”‚       ...                               â”‚
â”‚     },                                  â”‚
â”‚     paymentMethod: "e-wallet",          â”‚
â”‚     status: "pending_payment"           â”‚
â”‚   }                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”‚ 4. POST /api/orders
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Backend - Order Creation              â”‚
â”‚                                         â”‚
â”‚   1. Validate order data                â”‚
â”‚   2. Generate receipt number            â”‚
â”‚   3. Save to MongoDB                    â”‚
â”‚   4. Emit Socket.io event               â”‚
â”‚   5. Update customer totalOrders        â”‚
â”‚   6. Return order with ID               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”‚ 5. Order Created
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Frontend - Post-Order Actions         â”‚
â”‚                                         â”‚
â”‚   1. Clear cart                         â”‚
â”‚   2. Show order confirmation            â”‚
â”‚   3. Navigate to order status           â”‚
â”‚   4. Subscribe to order updates         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


MongoDB Document Created:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
{
  _id: ObjectId("..."),
  receiptNumber: "RNG-123456-789",
  customerId: ObjectId("507f1f..."),
  customerDetails: {
    name: "Juan Dela Cruz",
    phone: "09171234567",
    email: "juan@example.com"
  },
  items: [...],
  totals: {...},
  fulfillmentType: "delivery",
  deliveryAddressId: ObjectId("507f2a..."),
  deliveryAddress: {
    recipientName: "Juan Dela Cruz",
    street: "123 Street",
    barangay: "Malate",
    city: "Manila",
    province: "Metro Manila",
    ...
  },
  paymentMethod: "e-wallet",
  status: "pending_payment",
  createdAt: ISODate("2025-11-23T...")
}
```

---

## ğŸ”” Real-time Order Status Updates

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Customer   â”‚           â”‚   Server    â”‚           â”‚    Staff    â”‚
â”‚   Browser   â”‚           â”‚ (Socket.io) â”‚           â”‚    POS      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚                         â”‚                         â”‚
       â”‚ 1. Order Placed         â”‚                         â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                         â”‚
       â”‚                         â”‚                         â”‚
       â”‚ 2. Subscribe to order   â”‚                         â”‚
       â”‚    socket.emit(         â”‚                         â”‚
       â”‚      'subscribeToOrder',â”‚                         â”‚
       â”‚      orderId            â”‚                         â”‚
       â”‚    )                    â”‚                         â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                         â”‚
       â”‚                         â”‚                         â”‚
       â”‚ 3. Joined room          â”‚                         â”‚
       â”‚    "order:RNG-123456"   â”‚                         â”‚
       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                         â”‚
       â”‚                         â”‚                         â”‚
       â”‚                         â”‚ 4. Staff verifies pay   â”‚
       â”‚                         â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                         â”‚                         â”‚
       â”‚                         â”‚ 5. Update order status  â”‚
       â”‚                         â”‚    status = "preparing" â”‚
       â”‚                         â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                         â”‚                         â”‚
       â”‚ 6. Emit status update   â”‚                         â”‚
       â”‚    io.to('order:...')   â”‚                         â”‚
       â”‚    .emit(               â”‚                         â”‚
       â”‚      'orderStatusUpdate'â”‚                         â”‚
       â”‚    )                    â”‚                         â”‚
       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                         â”‚
       â”‚                         â”‚                         â”‚
       â”‚ 7. Update UI            â”‚                         â”‚
       â”‚    Show "Preparing"     â”‚                         â”‚
       â”‚    notification         â”‚                         â”‚
       â”‚                         â”‚                         â”‚
       â”‚                         â”‚ 8. Order ready          â”‚
       â”‚                         â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                         â”‚                         â”‚
       â”‚ 9. Emit status update   â”‚                         â”‚
       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                         â”‚
       â”‚                         â”‚                         â”‚
       â”‚ 10. Update UI           â”‚                         â”‚
       â”‚     Show "Ready"        â”‚                         â”‚
       â”‚     Play sound          â”‚                         â”‚
       â”‚                         â”‚                         â”‚
       â–¼                         â–¼                         â–¼


Socket.io Room Structure:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Global Rooms:
â”œâ”€ "staff:all" â†’ All POS terminals
â”œâ”€ "kitchen:all" â†’ Kitchen displays
â””â”€ "customer:507f..." â†’ Individual customer room

Order-Specific Rooms:
â”œâ”€ "order:RNG-123456" â†’ All subscribers to this order
â”œâ”€ "order:RNG-123457" â†’ All subscribers to this order
â””â”€ ...

Events:
â”œâ”€ "orderStatusUpdate" â†’ { orderId, status, timestamp }
â”œâ”€ "paymentVerified" â†’ { orderId, verifiedBy }
â”œâ”€ "paymentRejected" â†’ { orderId, reason }
â””â”€ "newPaymentOrder" â†’ { order } (for POS)
```

---

## ğŸ“± Self-Checkout Page Layout (with Accounts)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ— Ring & Wings                                          â”‚
â”‚                                                           â”‚
â”‚  NOT LOGGED IN:                                           â”‚
â”‚  [Login] [Sign Up]                           ğŸ›’ Cart (2) â”‚
â”‚                                                           â”‚
â”‚  LOGGED IN:                                               â”‚
â”‚  Welcome, Juan! â–¼                            ğŸ›’ Cart (2) â”‚
â”‚  â”œâ”€ My Orders                                             â”‚
â”‚  â”œâ”€ My Addresses                                          â”‚
â”‚  â””â”€ Logout                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ” [Search menu or scan item...]                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [Menu] [Cart] [My Orders]* (* if logged in)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  MENU TAB:                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Meals                                              â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚ â”‚
â”‚  â”‚  â”‚ [Img]   â”‚ â”‚ [Img]   â”‚ â”‚ [Img]   â”‚              â”‚ â”‚
â”‚  â”‚  â”‚ Chicken â”‚ â”‚ Burger  â”‚ â”‚ Fries   â”‚              â”‚ â”‚
â”‚  â”‚  â”‚ â‚±120    â”‚ â”‚ â‚±95     â”‚ â”‚ â‚±45     â”‚              â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚  Beverages                                          â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚ â”‚
â”‚  â”‚  â”‚ [Img]   â”‚ â”‚ [Img]   â”‚                           â”‚ â”‚
â”‚  â”‚  â”‚ Iced Teaâ”‚ â”‚ Soda    â”‚                           â”‚ â”‚
â”‚  â”‚  â”‚ â‚±35     â”‚ â”‚ â‚±40     â”‚                           â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                           â”‚
â”‚  CART TAB:                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Your Cart                                          â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚  â€¢ Fried Chicken (Large)  [âˆ’] 2 [+]  â‚±240.00      â”‚ â”‚
â”‚  â”‚  â€¢ Iced Tea (Medium)      [âˆ’] 1 [+]  â‚±35.00       â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚  Subtotal:                          â‚±275.00        â”‚ â”‚
â”‚  â”‚  Total:                             â‚±275.00        â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚  [Clear Cart]                    [Checkout â†’]      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                           â”‚
â”‚  MY ORDERS TAB: (only if logged in)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Current Order                                       â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚ ğŸ”µ Order #RNG-123456                        â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ Status: Preparing                           â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ â±ï¸ Est. 15 minutes                          â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ [View Details] [Track]                      â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚  Past Orders                                         â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚ âœ… Order #RNG-123445    Nov 22             â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ Completed              â‚±320.00             â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ [View] [Reorder]                           â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚ âœ… Order #RNG-123434    Nov 20             â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ Completed              â‚±580.00             â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ [View] [Reorder]                           â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚  [Load More Orders]                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¨ Component Hierarchy

```
SelfCheckout.jsx
â”‚
â”œâ”€ CustomerAuthContext.Provider
â”‚  â”‚
â”‚  â”œâ”€ Header Section
â”‚  â”‚  â”œâ”€ Logo
â”‚  â”‚  â”œâ”€ (Not logged in) LoginButton
â”‚  â”‚  â”œâ”€ (Not logged in) SignUpButton
â”‚  â”‚  â”œâ”€ (Logged in) CustomerAccountMenu
â”‚  â”‚  â”‚  â””â”€ Dropdown
â”‚  â”‚  â”‚     â”œâ”€ My Orders
â”‚  â”‚  â”‚     â”œâ”€ My Addresses
â”‚  â”‚  â”‚     â””â”€ Logout
â”‚  â”‚  â””â”€ CartIcon
â”‚  â”‚
â”‚  â”œâ”€ CustomerAuthModal
â”‚  â”‚  â”œâ”€ LoginForm
â”‚  â”‚  â”‚  â”œâ”€ PhoneInput
â”‚  â”‚  â”‚  â”œâ”€ PasswordInput
â”‚  â”‚  â”‚  â””â”€ SubmitButton
â”‚  â”‚  â””â”€ SignupForm
â”‚  â”‚     â”œâ”€ FirstNameInput
â”‚  â”‚     â”œâ”€ LastNameInput
â”‚  â”‚     â”œâ”€ PhoneInput
â”‚  â”‚     â”œâ”€ EmailInput (optional)
â”‚  â”‚     â”œâ”€ PasswordInput
â”‚  â”‚     â”œâ”€ ConfirmPasswordInput
â”‚  â”‚     â””â”€ SubmitButton
â”‚  â”‚
â”‚  â”œâ”€ SearchBar
â”‚  â”‚
â”‚  â”œâ”€ TabNavigation
â”‚  â”‚  â”œâ”€ MenuTab
â”‚  â”‚  â”œâ”€ CartTab
â”‚  â”‚  â””â”€ MyOrdersTab (conditional: if logged in)
â”‚  â”‚
â”‚  â”œâ”€ TabContent
â”‚  â”‚  â”‚
â”‚  â”‚  â”œâ”€ (Menu Tab)
â”‚  â”‚  â”‚  â”œâ”€ CategorySection (Meals)
â”‚  â”‚  â”‚  â”‚  â””â”€ MenuItemCard[]
â”‚  â”‚  â”‚  â””â”€ CategorySection (Beverages)
â”‚  â”‚  â”‚     â””â”€ MenuItemCard[]
â”‚  â”‚  â”‚
â”‚  â”‚  â”œâ”€ (Cart Tab)
â”‚  â”‚  â”‚  â”œâ”€ CartItemsList
â”‚  â”‚  â”‚  â”‚  â””â”€ CartItem[]
â”‚  â”‚  â”‚  â”œâ”€ CartSummary
â”‚  â”‚  â”‚  â””â”€ CheckoutButton
â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€ (My Orders Tab - if logged in)
â”‚  â”‚     â”œâ”€ CurrentOrderSection
â”‚  â”‚     â”‚  â””â”€ OrderStatusCard
â”‚  â”‚     â”‚     â”œâ”€ OrderNumber
â”‚  â”‚     â”‚     â”œâ”€ StatusBadge
â”‚  â”‚     â”‚     â”œâ”€ ProgressTimeline
â”‚  â”‚     â”‚     â”œâ”€ ItemsList
â”‚  â”‚     â”‚     â””â”€ ActionButtons
â”‚  â”‚     â”‚
â”‚  â”‚     â””â”€ OrderHistorySection
â”‚  â”‚        â””â”€ OrderHistoryCard[]
â”‚  â”‚           â”œâ”€ OrderNumber
â”‚  â”‚           â”œâ”€ Date
â”‚  â”‚           â”œâ”€ Status
â”‚  â”‚           â”œâ”€ Total
â”‚  â”‚           â””â”€ ActionButtons
â”‚  â”‚              â”œâ”€ ViewDetails
â”‚  â”‚              â””â”€ Reorder
â”‚  â”‚
â”‚  â”œâ”€ CheckoutFlow (Modal/Overlay)
â”‚  â”‚  â”œâ”€ OrderTypeSelector
â”‚  â”‚  â”œâ”€ DeliveryAddressSelector (if delivery)
â”‚  â”‚  â”‚  â”œâ”€ SavedAddressesList
â”‚  â”‚  â”‚  â”‚  â””â”€ AddressCard[]
â”‚  â”‚  â”‚  â””â”€ AddNewAddressButton
â”‚  â”‚  â”œâ”€ PaymentMethodSelector
â”‚  â”‚  â”œâ”€ ProofOfPaymentUpload
â”‚  â”‚  â””â”€ ConfirmationStep
â”‚  â”‚
â”‚  â”œâ”€ AddressFormModal
â”‚  â”‚  â”œâ”€ RecipientNameInput
â”‚  â”‚  â”œâ”€ RecipientPhoneInput
â”‚  â”‚  â”œâ”€ StreetInput
â”‚  â”‚  â”œâ”€ BarangayInput
â”‚  â”‚  â”œâ”€ CityInput
â”‚  â”‚  â”œâ”€ ProvinceInput
â”‚  â”‚  â”œâ”€ PostalCodeInput
â”‚  â”‚  â”œâ”€ LandmarkInput
â”‚  â”‚  â”œâ”€ DeliveryNotesTextarea
â”‚  â”‚  â”œâ”€ LabelSelector (Home/Work/Other)
â”‚  â”‚  â”œâ”€ SetAsDefaultCheckbox
â”‚  â”‚  â””â”€ SaveButton
â”‚  â”‚
â”‚  â””â”€ AlternativesModal
â”‚     â””â”€ (existing functionality)
â”‚
â””â”€ SelfCheckoutAIAssistant
   â””â”€ (existing functionality)
```

---

## ğŸ” Security Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   AUTHENTICATION FLOW                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Client Side:                    Server Side:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Browser    â”‚                â”‚   Express.js     â”‚
â”‚              â”‚                â”‚                  â”‚
â”‚ 1. Sign Up   â”‚                â”‚                  â”‚
â”‚    Form      â”‚                â”‚                  â”‚
â”‚    â”œâ”€ Phone  â”‚                â”‚                  â”‚
â”‚    â””â”€ Pass   â”‚                â”‚                  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚                  â”‚
       â”‚                        â”‚                  â”‚
       â”‚ POST /api/customer/    â”‚                  â”‚
       â”‚      auth/signup       â”‚                  â”‚
       â”‚ {                      â”‚                  â”‚
       â”‚   phone: "0917...",    â”‚                  â”‚
       â”‚   password: "pass123"  â”‚                  â”‚
       â”‚ }                      â”‚                  â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ 2. Validate     â”‚
                                â”‚    Input        â”‚
                                â”‚                  â”‚
                                â”‚ 3. Check if     â”‚
                                â”‚    exists       â”‚
                                â”‚                  â”‚
                                â–¼                  â”‚
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
                         â”‚   MongoDB    â”‚         â”‚
                         â”‚              â”‚         â”‚
                         â”‚ Check phone  â”‚         â”‚
                         â”‚ uniqueness   â”‚         â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
                                â”‚                  â”‚
                                â”‚ Not found âœ“      â”‚
                                â–¼                  â”‚
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
                         â”‚   bcrypt     â”‚         â”‚
                         â”‚              â”‚         â”‚
                         â”‚ Hash pass    â”‚         â”‚
                         â”‚ (12 rounds)  â”‚         â”‚
                         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
                                â”‚                  â”‚
                                â–¼                  â”‚
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
                         â”‚   MongoDB    â”‚         â”‚
                         â”‚              â”‚         â”‚
                         â”‚ Save customerâ”‚         â”‚
                         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
                                â”‚                  â”‚
                                â–¼                  â”‚
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
                         â”‚   JWT        â”‚         â”‚
                         â”‚              â”‚         â”‚
                         â”‚ Sign token:  â”‚         â”‚
                         â”‚ {            â”‚         â”‚
                         â”‚   _id,       â”‚         â”‚
                         â”‚   phone,     â”‚         â”‚
                         â”‚   type:      â”‚         â”‚
                         â”‚   'customer' â”‚         â”‚
                         â”‚ }            â”‚         â”‚
                         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
                                â”‚                  â”‚
                                â”‚ 4. Return token  â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚
       â”‚ { customer, token }    â”‚                  â”‚
       â–¼                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Browser    â”‚
â”‚              â”‚
â”‚ 5. Store     â”‚
â”‚    token in  â”‚
â”‚    localStorage:                                 â”‚
â”‚    'customer_token'                              â”‚
â”‚                                                  â”‚
â”‚ 6. Set auth  â”‚
â”‚    header forâ”‚
â”‚    future    â”‚
â”‚    requests: â”‚
â”‚    Authorization:                                â”‚
â”‚    Bearer <token>                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


Token Separation Strategy:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Staff Token:
localStorage.getItem('token')
Payload: { _id, role: 'staff', position: 'cashier', type: 'staff' }

Customer Token:
localStorage.getItem('customer_token')
Payload: { _id, phone: '0917...', type: 'customer' }

Middleware Verification:
â”œâ”€ auth (staff) â†’ Checks 'token', validates type: 'staff'
â””â”€ authenticateCustomer â†’ Checks 'customer_token', validates type: 'customer'
```

---

## ğŸ“Š Performance & Scaling Considerations

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               PERFORMANCE OPTIMIZATION                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Database Indexes:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… customers.phone (unique)
âœ… customers.email (sparse, unique)
âœ… customeraddresses.customerId + isDefault
âœ… orders.customerId + createdAt
âœ… orders.customerId + status

Expected Impact:
â”œâ”€ Customer lookup by phone: O(1) vs O(n)
â”œâ”€ Order history query: 10x faster
â””â”€ Address fetch: 5x faster


Caching Strategy:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Redis Cache   â”‚
â”‚                 â”‚
â”‚ Customer data   â”‚  TTL: 15 minutes
â”‚ Order history   â”‚  TTL: 5 minutes
â”‚ Addresses       â”‚  TTL: 30 minutes
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”œâ”€ Cache on login
        â”œâ”€ Invalidate on update
        â””â”€ Warm on first request


Socket.io Rooms:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Per-Customer Room:
io.to(`customer:${customerId}`).emit(...)

Benefits:
â”œâ”€ Targeted updates
â”œâ”€ Reduced bandwidth
â””â”€ Better privacy


Frontend Optimizations:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… React.memo for OrderHistoryCard
âœ… useMemo for cart totals
âœ… Debounced search
âœ… Lazy load order history (pagination)
âœ… Image lazy loading
âœ… Bundle splitting

Code Splitting Example:
const OrderHistoryModal = React.lazy(() => 
  import('./components/customer/OrderHistoryModal')
);


API Response Pagination:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
GET /api/customer/orders?page=1&limit=10

Response:
{
  orders: [...],
  pagination: {
    total: 150,
    page: 1,
    limit: 10,
    pages: 15
  }
}


Estimated Throughput:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
With proper indexes:
â”œâ”€ Login: 500 req/sec
â”œâ”€ Order creation: 200 req/sec
â”œâ”€ Order history: 1000 req/sec
â””â”€ Cart sync: 300 req/sec

Without indexes:
â”œâ”€ Login: 50 req/sec
â”œâ”€ Order creation: 50 req/sec
â”œâ”€ Order history: 100 req/sec
â””â”€ Cart sync: 80 req/sec
```

---

## ğŸ¯ Summary Diagram: Complete Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           CUSTOMER JOURNEY - END TO END                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. DISCOVERY
   Customer arrives â†’ Self-Checkout page
   
2. AUTHENTICATION (Optional)
   Sign Up â†’ Verify phone â†’ Create account
   OR
   Login â†’ Verify credentials â†’ Session created
   
3. BROWSING
   Browse menu â†’ Search items â†’ View details
   
4. CART MANAGEMENT
   Add to cart â†’ Adjust quantities â†’ Select sizes
   (Cart synced to server if logged in)
   
5. CHECKOUT INITIATION
   Click "Checkout" â†’ Choose order type
   IF Delivery â†’ Select/add delivery address
   
6. PAYMENT SELECTION
   Choose payment method â†’ Upload proof (if e-wallet)
   
7. ORDER CREATION
   Submit order â†’ Order saved with customer link
   â†’ Delivery address snapshot saved
   â†’ Cart cleared
   
8. ORDER TRACKING
   Receive order number â†’ Subscribe to updates (Socket.io)
   â†’ View order status in real-time
   â†’ Get notifications on status changes
   
9. ORDER HISTORY
   View past orders â†’ Reorder functionality
   â†’ View receipts â†’ Track delivery
   
10. REPEAT CUSTOMER
    Next visit â†’ Auto-login â†’ Previous cart restored
    â†’ Saved addresses available â†’ Faster checkout


Key Benefits:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… Persistent cart across devices
âœ… Saved delivery addresses
âœ… Order history and tracking
âœ… Faster repeat orders (reorder button)
âœ… Real-time status updates
âœ… Personalized experience
```

---

## ğŸ“ Notes

- All diagrams use ASCII art for universal compatibility
- Architecture supports both guest and logged-in flows
- System designed for horizontal scaling
- Security follows industry best practices
- Real-time updates minimize customer uncertainty
- Data snapshots ensure historical accuracy

---

**For implementation details, see:**
- `USER_ACCOUNTS_SYSTEM_ANALYSIS.md` - Full specification
- `USER_ACCOUNTS_QUICK_START.md` - Implementation guide
